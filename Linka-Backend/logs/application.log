2025-11-23 04:28:07 [main] INFO  c.l.backend.BackendApplicationTests - Starting BackendApplicationTests using Java 21.0.8 with PID 18364 (started by Hp in C:\Users\Hp\Desktop\Projects\LinkA\Linka-Backend)
2025-11-23 04:28:07 [main] DEBUG c.l.backend.BackendApplicationTests - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-23 04:28:07 [main] INFO  c.l.backend.BackendApplicationTests - The following 1 profile is active: "dev"
2025-11-23 04:28:10 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-23 04:28:10 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 145 ms. Found 3 JPA repository interfaces.
2025-11-23 04:28:11 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-23 04:28:12 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-23 04:28:12 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-23 04:28:13 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-23 04:28:13 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-23 04:28:13 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-11-23 04:28:13 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-23 04:28:13 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-23 04:28:13 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-23 04:28:16 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    drop table if exists categories cascade 
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    drop table if exists listing_attributes cascade 
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    drop table if exists listing_images cascade 
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    drop table if exists listings cascade 
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    drop table if exists reviews cascade 
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    drop table if exists transactions cascade 
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    drop table if exists users cascade 
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    create table categories (
        is_active boolean not null,
        is_featured boolean not null,
        item_count integer not null,
        sort_order integer not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        parent_category_id bigint,
        updated_at timestamp(6) not null,
        meta_title varchar(60),
        name varchar(100) not null unique,
        meta_description varchar(160),
        description TEXT,
        color_code varchar(255),
        emoji_symbol varchar(255),
        gradient_class varchar(255),
        icon_name varchar(255),
        seo_keywords varchar(255),
        slug varchar(255) not null unique,
        primary key (id)
    )
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    create table listing_attributes (
        display_order integer not null,
        is_searchable boolean not null,
        id bigint generated by default as identity,
        listing_id bigint not null,
        attribute_name varchar(100) not null,
        attribute_value varchar(500) not null,
        attribute_type enum ('BOOLEAN','COLOR','DATE','DIMENSION','MULTISELECT','NUMBER','SELECT','SIZE','TEXT','WEIGHT'),
        primary key (id)
    )
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    create table listing_images (
        listing_id bigint not null,
        image_url varchar(255)
    )
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    create table listings (
        allow_offers boolean not null,
        auto_approve_offers boolean not null,
        contact_count integer not null,
        favorite_count integer not null,
        featured_image_index integer not null,
        is_featured boolean not null,
        is_negotiable boolean not null,
        is_premium boolean not null,
        latitude numeric(10,8),
        longitude numeric(11,8),
        min_order_quantity integer,
        minimum_offer numeric(15,2),
        original_price numeric(15,2),
        price numeric(15,2) not null,
        quantity_available integer,
        view_count integer not null,
        weight_kg numeric(8,3),
        archived_at timestamp(6),
        category_id bigint not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6),
        featured_until timestamp(6),
        id bigint generated by default as identity,
        premium_until timestamp(6),
        published_at timestamp(6),
        seller_id bigint not null,
        updated_at timestamp(6) not null,
        seo_title varchar(60),
        seo_description varchar(160),
        title varchar(200) not null,
        description TEXT,
        barcode varchar(255),
        brand varchar(255),
        city varchar(255),
        color varchar(255),
        dimensions varchar(255),
        district varchar(255),
        location varchar(255),
        main_image varchar(255),
        material varchar(255),
        model varchar(255),
        size varchar(255),
        sku varchar(255),
        tags varchar(255),
        condition_type enum ('FAIR','GOOD','LIKE_NEW','NEW','POOR','REFURBISHED') not null,
        listing_type enum ('BUY','EVENT','JOB','RENT','SELL','SERVICE') not null,
        status enum ('ACTIVE','ARCHIVED','DELETED','DRAFT','EXPIRED','PAUSED','PENDING_APPROVAL','REJECTED','SOLD') not null,
        primary key (id)
    )
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    create table reviews (
        helpful_count integer not null,
        is_featured boolean not null,
        is_public boolean not null,
        is_verified_purchase boolean not null,
        not_helpful_count integer not null,
        rating integer not null check ((rating>=1) and (rating<=5)),
        admin_response_date timestamp(6),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        listing_id bigint not null,
        reviewee_id bigint,
        reviewer_id bigint not null,
        transaction_id bigint,
        updated_at timestamp(6) not null,
        comment TEXT,
        admin_response varchar(255),
        cons varchar(255),
        pros varchar(255),
        primary key (id)
    )
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    create table transactions (
        amount numeric(15,2) not null,
        delivery_fee numeric(15,2),
        platform_fee numeric(15,2),
        quantity integer not null,
        refund_amount numeric(15,2),
        total_amount numeric(15,2),
        transaction_fee numeric(15,2),
        actual_delivery_date timestamp(6),
        buyer_id bigint not null,
        cancellation_date timestamp(6),
        completed_at timestamp(6),
        created_at timestamp(6) not null,
        dispute_date timestamp(6),
        estimated_delivery_date timestamp(6),
        id bigint generated by default as identity,
        listing_id bigint not null,
        refund_date timestamp(6),
        seller_id bigint not null,
        updated_at timestamp(6) not null,
        admin_notes varchar(255),
        cancellation_reason varchar(255),
        card_last_four varchar(255),
        delivery_address varchar(255),
        delivery_city varchar(255),
        delivery_district varchar(255),
        delivery_instructions varchar(255),
        delivery_phone varchar(255),
        dispute_reason varchar(255),
        dispute_resolution varchar(255),
        mobile_money_number varchar(255),
        notes varchar(255),
        payment_provider varchar(255),
        payment_provider_reference varchar(255),
        transaction_reference varchar(255) not null unique,
        delivery_status enum ('DELIVERED','FAILED','IN_TRANSIT','OUT_FOR_DELIVERY','PENDING','RETURNED','SCHEDULED'),
        payment_method enum ('BANK_TRANSFER','CASH_ON_DELIVERY','CREDIT_CARD','CRYPTO','DEBIT_CARD','MOBILE_MONEY','PAYPAL') not null,
        payment_status enum ('CANCELLED','COMPLETED','FAILED','PARTIALLY_REFUNDED','PENDING','PROCESSING','REFUNDED') not null,
        transaction_status enum ('CANCELLED','COMPLETED','CONFIRMED','DELIVERED','DISPUTED','INITIATED','PROCESSING','REFUNDED') not null,
        primary key (id)
    )
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    create table users (
        email_verified boolean not null,
        failed_login_attempts integer not null,
        login_count integer not null,
        phone_verified boolean not null,
        rating_average float(53),
        rating_count integer,
        total_purchases integer,
        total_sales integer,
        verified_seller boolean not null,
        account_locked_until timestamp(6),
        created_at timestamp(6) not null,
        date_of_birth timestamp(6),
        id bigint generated by default as identity,
        last_login timestamp(6),
        updated_at timestamp(6) not null,
        business_license varchar(255),
        city varchar(255),
        country varchar(255) not null,
        district varchar(255),
        email varchar(255) not null unique,
        first_name varchar(255) not null,
        last_name varchar(255) not null,
        location varchar(255),
        national_id varchar(255),
        notification_preferences varchar(255),
        password varchar(255) not null,
        phone_number varchar(255) not null,
        preferred_language varchar(255) not null,
        profile_image varchar(255),
        tax_id varchar(255),
        gender enum ('FEMALE','MALE','OTHER','PREFER_NOT_TO_SAY'),
        status enum ('ACTIVE','BANNED','DEACTIVATED','PENDING_VERIFICATION','SUSPENDED') not null,
        user_type enum ('ADMIN','BOTH','BUYER','SELLER') not null,
        primary key (id)
    )
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists categories 
       add constraint FK9il7y6fehxwunjeepq0n7g5rd 
       foreign key (parent_category_id) 
       references categories
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists listing_attributes 
       add constraint FKcybccpu0x17fky6xwlssksckw 
       foreign key (listing_id) 
       references listings
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists listing_images 
       add constraint FKq8bkplrutxrfur5u7pppml04y 
       foreign key (listing_id) 
       references listings
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists listings 
       add constraint FKbyfn7t3i7g0f11pcy5veh088p 
       foreign key (category_id) 
       references categories
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists listings 
       add constraint FKdfglshentvek3cnsr7a4nwh7j 
       foreign key (seller_id) 
       references users
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists reviews 
       add constraint FKef8fmvjeprcadspus2mmbo1aa 
       foreign key (listing_id) 
       references listings
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists reviews 
       add constraint FK1sjw2c8j34ew366vfqxergp0b 
       foreign key (reviewee_id) 
       references users
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists reviews 
       add constraint FKd1isgfajhtdl8mgg29up6mofi 
       foreign key (reviewer_id) 
       references users
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists reviews 
       add constraint FKkaqv178xysaxtwl8vo0vyb9cs 
       foreign key (transaction_id) 
       references transactions
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists transactions 
       add constraint FKijk7ii2fvalv59schbb3e0bof 
       foreign key (buyer_id) 
       references users
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists transactions 
       add constraint FKgpnxemro2596g2kplteoi6m01 
       foreign key (listing_id) 
       references listings
2025-11-23 04:28:16 [main] DEBUG org.hibernate.SQL - 
    alter table if exists transactions 
       add constraint FK50i2jege2ukupf1ynv0dq6eax 
       foreign key (seller_id) 
       references users
2025-11-23 04:28:16 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-23 04:28:18 [main] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-23 04:28:21 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-23 04:28:21 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 3 endpoints beneath base path '/actuator'
2025-11-23 04:28:21 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name authService
2025-11-23 04:28:22 [main] INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-11-23 04:28:23 [main] INFO  c.l.backend.BackendApplicationTests - Started BackendApplicationTests in 16.786 seconds (process running for 19.565)
2025-11-23 04:28:23 [main] DEBUG org.hibernate.SQL - 
    select
        count(*) 
    from
        users u1_0
2025-11-23 04:28:24 [main] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (account_locked_until, business_license, city, country, created_at, date_of_birth, district, email, email_verified, failed_login_attempts, first_name, gender, last_login, last_name, location, login_count, national_id, notification_preferences, password, phone_number, phone_verified, preferred_language, profile_image, rating_average, rating_count, status, tax_id, total_purchases, total_sales, updated_at, user_type, verified_seller, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-23 04:28:24 [main] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (account_locked_until, business_license, city, country, created_at, date_of_birth, district, email, email_verified, failed_login_attempts, first_name, gender, last_login, last_name, location, login_count, national_id, notification_preferences, password, phone_number, phone_verified, preferred_language, profile_image, rating_average, rating_count, status, tax_id, total_purchases, total_sales, updated_at, user_type, verified_seller, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-23 04:28:24 [main] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (account_locked_until, business_license, city, country, created_at, date_of_birth, district, email, email_verified, failed_login_attempts, first_name, gender, last_login, last_name, location, login_count, national_id, notification_preferences, password, phone_number, phone_verified, preferred_language, profile_image, rating_average, rating_count, status, tax_id, total_purchases, total_sales, updated_at, user_type, verified_seller, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-23 04:28:24 [main] DEBUG org.hibernate.SQL - 
    select
        count(*) 
    from
        categories c1_0
2025-11-23 04:28:24 [main] DEBUG org.hibernate.SQL - 
    insert 
    into
        categories
        (is_active, color_code, created_at, description, emoji_symbol, is_featured, gradient_class, icon_name, item_count, meta_description, meta_title, name, parent_category_id, seo_keywords, slug, sort_order, updated_at, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-23 04:28:24 [main] DEBUG org.hibernate.SQL - 
    insert 
    into
        categories
        (is_active, color_code, created_at, description, emoji_symbol, is_featured, gradient_class, icon_name, item_count, meta_description, meta_title, name, parent_category_id, seo_keywords, slug, sort_order, updated_at, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-23 04:28:24 [main] DEBUG org.hibernate.SQL - 
    insert 
    into
        categories
        (is_active, color_code, created_at, description, emoji_symbol, is_featured, gradient_class, icon_name, item_count, meta_description, meta_title, name, parent_category_id, seo_keywords, slug, sort_order, updated_at, id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, default)
2025-11-23 04:28:25 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-23 04:28:25 [SpringApplicationShutdownHook] DEBUG org.hibernate.SQL - 
    drop table if exists categories cascade 
2025-11-23 04:28:25 [SpringApplicationShutdownHook] DEBUG org.hibernate.SQL - 
    drop table if exists listing_attributes cascade 
2025-11-23 04:28:25 [SpringApplicationShutdownHook] DEBUG org.hibernate.SQL - 
    drop table if exists listing_images cascade 
2025-11-23 04:28:25 [SpringApplicationShutdownHook] DEBUG org.hibernate.SQL - 
    drop table if exists listings cascade 
2025-11-23 04:28:25 [SpringApplicationShutdownHook] DEBUG org.hibernate.SQL - 
    drop table if exists reviews cascade 
2025-11-23 04:28:25 [SpringApplicationShutdownHook] DEBUG org.hibernate.SQL - 
    drop table if exists transactions cascade 
2025-11-23 04:28:25 [SpringApplicationShutdownHook] DEBUG org.hibernate.SQL - 
    drop table if exists users cascade 
2025-11-23 04:28:25 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-23 04:28:25 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
