spring:
  application:
    name: ${APP_NAME:backend}
  profiles:
    active: ${PROFILE:dev}
  datasource:
    url: ${DB_URL:jdbc:h2:mem:testdb}
    driver-class-name: ${DB_DRIVER:org.h2.Driver}
    username: ${DB_USERNAME:sa}
    password: ${DB_PASSWORD:}
  jpa:
    hibernate:
      ddl-auto: ${JPA_DDL_AUTO:create-drop}
    show-sql: ${JPA_SHOW_SQL:false}
    properties:
      hibernate:
        dialect: ${HIBERNATE_DIALECT:org.hibernate.dialect.H2Dialect}
        format_sql: ${HIBERNATE_FORMAT_SQL:true}
  h2:
    console:
      enabled: ${H2_CONSOLE_ENABLED:true}
      path: ${H2_CONSOLE_PATH:/h2-console}
  mail:
    host: ${SMTP_HOST:localhost}
    port: ${SMTP_PORT:1025}
    username: ${SMTP_USERNAME:}
    password: ${SMTP_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: ${SMTP_AUTH:false}
          starttls:
            enable: ${SMTP_STARTTLS_ENABLE:false}
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
      database: ${REDIS_DATABASE:0}
  servlet:
    multipart:
      max-file-size: ${MAX_FILE_SIZE:10MB}
      max-request-size: ${MAX_REQUEST_SIZE:50MB}

server:
  port: ${SERVER_PORT:8081}
  servlet:
    context-path: ${SERVER_CONTEXT_PATH:}
  compression:
    enabled: ${SERVER_COMPRESSION_ENABLED:true}
  http2:
    enabled: ${SERVER_HTTP2_ENABLED:true}

# LinkA Configuration
linka:
  # Security Configuration
  security:
    jwt:
      secret: ${JWT_SECRET:your-default-jwt-secret}
      expiration: ${JWT_EXPIRATION:86400000}
    cors:
      allowed-origins: ${CORS_ORIGINS:http://localhost:5173}
    csrf:
      enabled: ${CSRF_ENABLED:false}
  # Mobile Money Configuration
  mobile-money:
    mtn:
      min: ${MOBILE_MONEY_MTN_MIN:500}
      max: ${MOBILE_MONEY_MTN_MAX:5000000}
      fee: ${MOBILE_MONEY_MTN_FEE:0.01}
    airtel:
      min: ${MOBILE_MONEY_AIRTEL_MIN:500}
      max: ${MOBILE_MONEY_AIRTEL_MAX:3000000}
      fee: ${MOBILE_MONEY_AIRTEL_FEE:0.015}
    mula:
      min: ${MOBILE_MONEY_MULA_MIN:1000}
      max: ${MOBILE_MONEY_MULA_MAX:2000000}
      fee: ${MOBILE_MONEY_MULA_FEE:0.005}
  # Rate Limiting Configuration
  rate-limiting:
    enabled: ${RATE_LIMIT_ENABLED:false}
    requests-per-minute: ${RATE_LIMIT_REQUESTS_PER_MINUTE:60}
    burst-capacity: ${RATE_LIMIT_BURST_CAPACITY:100}
  # Feature Flags
  features:
    debug-mode: ${DEBUG_MODE:false}
    dev-tools: ${SPRING_DEVTOOLS_ENABLED:false}
    email-enabled: ${EMAIL_ENABLED:false}
    health-check-enabled: ${HEALTH_CHECK_ENABLED:true}
    json-logging: ${JSON_LOGGING:false}

# Logging Configuration
logging:
  level:
    com.linka.backend: ${LOG_LEVEL:INFO}
    org.hibernate.SQL: ${HIBERNATE_SQL_LEVEL:DEBUG}
    org.hibernate.type.descriptor.sql.BasicBinder: ${HIBERNATE_BINDER_LEVEL:TRACE}
  pattern:
    console: ${LOG_PATTERN_CONSOLE:%d{yyyy-MM-dd HH:mm:ss} - %msg%n}
    file: ${LOG_PATTERN_FILE:%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n}
  file:
    name: ${LOG_FILE_PATH:logs/application.log}
    max-size: ${LOG_MAX_FILE_SIZE:10MB}
    max-history: ${LOG_MAX_HISTORY:30}
  logback:
    rollingpolicy:
      max-file-size: ${LOG_MAX_FILE_SIZE:10MB}
      max-history: ${LOG_MAX_HISTORY:30}
      total-size-cap: ${LOG_TOTAL_SIZE_CAP:1GB}

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: ${ACTUATOR_ENDPOINTS:health,info,metrics,prometheus}
      base-path: ${ACTUATOR_BASE_PATH:/actuator}
  endpoint:
    health:
      show-details: ${HEALTH_DETAILED_ENABLED:when-authorized}
      show-components: ${HEALTH_SHOW_COMPONENTS:when-authorized}
  prometheus:
    metrics:
      export:
        enabled: ${PROMETHEUS_ENABLED:false}



---
# Production Profile
spring:
  config:
    activate:
      on-profile: prod
  datasource:
    url: ${DB_URL}
    driver-class-name: org.postgresql.Driver
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true
  mail:
    host: ${SMTP_HOST}
    username: ${SMTP_USERNAME}
    password: ${SMTP_PASSWORD}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
  data:
    redis:
      host: ${REDIS_HOST}
      password: ${REDIS_PASSWORD}

logging:
  level:
    com.linka.backend: WARN
    org.hibernate.SQL: WARN
    org.hibernate.type.descriptor.sql.BasicBinder: WARN
  pattern:
    console: ${LOG_PATTERN_CONSOLE:%d{yyyy-MM-dd HH:mm:ss} - %msg%n}
  file:
    name: ${LOG_FILE_PATH}
  logback:
    rollingpolicy:
      max-file-size: ${LOG_MAX_FILE_SIZE:100MB}

linka:
  security:
    cors:
      allowed-origins: ${FRONTEND_URLS:https://linka.com,https://www.linka.com}
  features:
    debug-mode: false
    dev-tools: false
    email-enabled: true
    json-logging: true

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: never

---
# Development Profile
spring:
  config:
    activate:
      on-profile: dev
  jpa:
    show-sql: true
    hibernate:
      ddl-auto: create-drop
  h2:
    console:
      enabled: true

logging:
  level:
    com.linka.backend: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
  pattern:
    console: ${LOG_PATTERN_CONSOLE:%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n}

linka:
  security:
    cors:
      allowed-origins: ${CORS_ORIGINS:http://localhost:5173,http://localhost:3000}
  features:
    debug-mode: true
    dev-tools: true
    email-enabled: false
    json-logging: false
